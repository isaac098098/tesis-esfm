%%% Funciones pares
\newpage
\section{Funciones pares}

Al estudiar el espacio de funciones aritméticas se puede hacer una analogía con la teoría de Fourier del análisis para funciones definidas en todo el plano real o complejo, para la cuál se necesitará la noción de periodicidad. En este capítulo se considerarán dos clases de funciones aritméticas que capturan esta noción y se probará que son equivalentes. También se expondran resultados análogos a los de análisis respecto a funciones periódicas. Estos  resultados se puede encontrar en \cite{Coh1}.

\begin{remark}
Durante todo el capítulo se supondrá que $r$ es un entero positivo arbitrario pero fijo.
\end{remark}

\begin{definition}[Función par]
Una función aritmética se dice \textbf{par} $\Mod{r}$ si $f(n)=f((n,r))$, donde $(m,r)$ es el máximo común divisor de $n$ y $r$, para cada $n \in \mathbb{N}$.
\end{definition}

\begin{definition}[Función periódica]
Una función aritmética se dice \textbf{periódica} con periodo $r$ (o periódica $\Mod{r}$) si $m, n \in \mathbb{N}$ y $m \equiv n \pmod{r}$ implica que $f(m)=f(n)$.
\end{definition}

La siguiente proposición es una consecuencia inmediata de las definiciones anteriores.

\begin{proposition}
Toda función par $\Mod{r}$ es periódica con periodo $r$.
\end{proposition}
\begin{proof}
Si $m \equiv n \pmod{r}$ entonces $r \mid m-n$, por tanto existe $q \in \mathbb{Z}$ tal que $m-n=q r$. Por demostrar que $(n,r)=(m,r)$. En efecto, como $(n,r) \mid n$ y $(n,r) \mid r$, entonces $(n,r) \mid n+qr=m$, luego $(n,r) \mid (m,r)$. Análogamente, se tiene que $(m,r) \mid (n,r)$. Se sigue que $(n,r)=(m,r)$ y por tanto $f(n)=f((n,r))=f((m,r))=f(m)$.
\end{proof}

\subsection{Sumas de Ramanujan}

\begin{definition}[Sumas de Ramanujan]
Se define la función aritmética $c_r$ como
\begin{equation}\label{eq:ram0}
    c_r(n) = \sum_{d \mid (n,r)} \mu \left( \frac{r}{d} \right) d.
\end{equation}
Esta función será referida como la suma de Ramanujan módulo $r$ o simplemente suma de Ramanujan cuando no haya riesgo de confusión.
\end{definition}

\begin{proposition}
Algunas propiedades de la sumas de Ramanujan son las siguientes:
\begin{enumerate}[label=\textnormal{(\arabic*)},ref=\textnormal{\arabic*}]
\item $c_1 = \mathbf{1}$
\item $c_r(1) = \mu(r)$
\item $c_r(n) \le \max \{ \sigma(r), \sigma(n) \}$
\item \label{it:ram1} $c_r(n)$ es una función multiplicativa de $r$
\item Si $p$ es primo y $m$ es un entero positivo, entonces
    \begin{equation*}
        c_{p^m}(n) = \begin{cases}
            \hfil p^m - p^{m-1} & \text{si } p^m \mid n \\
            \hfil -p^{m-1} & \text{si } p^{m-1} \text{ pero } p^m \centernot\mid n \\
            \hfil 0 & \text{si } p^{m-1} \centernot\mid n.
        \end{cases}
    \end{equation*}
\end{enumerate}
\end{proposition}

\begin{proof}
\begin{enumerate}[label=\textnormal{(\arabic*)}]
\item Para cada $n \in \mathbb{N}$ se tiene que $(n,1)=1$ y por tanto
    \begin{equation*}
        c_1(n) = \sum_{d \mid (n,1)} \mu \left( \frac{1}{d} \right) d = \mu(1) 1 = 1.
    \end{equation*}
\item De manera similar,
    \begin{equation*}
        c_r(1) = \sum_{d \mid (1,r)} \mu \left( \frac{r}{d} \right) d = \mu(r) 1 = \mu(r).
    \end{equation*}
\item Por definición se tiene que $\sigma(k) = \sum_{d \mid k} d$. Además $\mu(k) \le 1$ para todo $k \in \mathbb{N}$, luego
    \begin{equation*}
        c_r(n) = \sum_{d \mid (n,r)} \mu \left( \frac{r}{d} \right) d \le \sum_{d \mid (n,r)} d = \sum_{\substack{d \mid n \\ d \mid r}} d \le \sum_{d \mid n} d, \sum_{d \mid r} d \le \max \{ \sigma(n),\sigma(r) \}.
    \end{equation*}
\item Defínase
    \begin{equation*}
        \eta_r(n) = \begin{cases}
            \hfil r & \text{si } r \mid n \\
            \hfil 0 & \text{en otro caso}.
        \end{cases}
    \end{equation*}
Se tiene que la función $\eta_\Box(n)$ es multiplicativa para $n$ fijo. En efecto, si $r,s \in \mathbb{N}$ son tales que $(r,s)=1$, entonces
\begin{equation*}
    \eta_{r s}(n) = \begin{cases}
        \hfil r s & \text{si } r s \mid n \\
        \hfil 0 & \text{en otro caso,}
    \end{cases}
\end{equation*}
pero $r s \mid n$ si y sólo si $r \mid n$ y $s \mid n$. En efecto, si $r s \mid n$ es claro que $r \mid n$ y $s \mid n$. Supóngase que $r \mid n$ y $s \mid n$, de tal manera que existen $q_1, q_2 \in \mathbb{Z}$ tales que $n=r q_1=s q_2$. Como $(r,s)=1$, también existen $x, y \in \mathbb{Z}$ tales que $1=r x + s y$, luego $n=n r x + n s y$, por lo que $n= r s (q_2 x + q_1 y)$, es decir, $r s \mid n$. Luego, si $r s \mid n$, entonces
\begin{equation*}
    \eta_{r s}(n) = r s = \eta_r(n) \eta_s(n),
\end{equation*}
y si $r s \centernot\mid$ entonces $r \centernot\mid n$ y $s \centernot\mid n$, por lo que
\begin{equation*}
    \eta_{r s}(0) = 0 = \eta_r(n) \eta_s(n).
\end{equation*}

Por otro lado, se tiene que
\begin{equation*}
    \sum_{d \mid r} \mu \left( \frac{r}{d} \right) \eta_d(n) = \sum_{\substack{d \mid r \\ d \mid n}} \mu \left( \frac{r}{d} \right) d = \sum_{d \mid (n,r)} \mu \left( \frac{r}{d} \right) d = c_r(n),
\end{equation*}
es decir, $c_\Box(n)=\mu*\eta_\Box(n)$. Luego $c_\Box(n)$ debe ser multiplicativa para $n$ fijo, por ser producto de funciones multiplicativas.
\item Tenemos los siguientes casos:
\begin{itemize}
\item Si $p^m \mid n$, entonces $(n,p^m)=p^m$, luego
    \begin{equation*}
        c_{p^m}(n) = \sum_{d \mid p^m} \mu \left( \frac{p^m}{d} \right) d = \mu(1) p^m + \mu(p) p^{m-1} = p^m - p^{m-1},
    \end{equation*}
    pues $\mu(p^i)=0$ para toda $i > 1$.
\item Si $p^{m-1} \mid n$ pero $p^m \centernot\mid n$, entonces $(n,p^m)=p^{m-1}$. En efecto, se tiene que $p^{m-1} \mid p^m$ y además $p^{m-1} \mid n$ por hipótesis. Si $e \in \mathbb{Z}$ es tal que $e \mid p^{m}$ y $e \mid n$, entonces $e=p^i$, para algún $0 \le i \le m-1$, pues $p^m \centernot\mid n$, por tanto $e \mid p^{m-1}$. Esto prueba que $(p^m,n)=p^{m-1}$, así
    \begin{equation*}
        c_{p^m}(n) = \sum_{d \mid p^{m-1}} \mu \left( \frac{p^m}{d} \right) d = \mu(p) p^{m-1} = -p^{m-1}
    \end{equation*}
    
\item Finalmente, si $p^{m-1} \centernot\mid n$, entonces $p^m \centernot\mid n$. Además, $(n,p^m) \mid p^m$, por tanto $(n,p^m)=p^i$ para algún $0 \le i \le m$. Más aún, por la hipótesis se debe tener que $0 \le i \le m-2$. Luego
    \begin{equation*}
        c_{p^m}(n) = \sum_{d \mid p^i} \mu \left( \frac{p^m}{d} \right) d = \mu(p^m)1+ \mu(p^{m-1}) p + \cdots + \mu(p^{m-i}) p^i = 0,
    \end{equation*}
    pues $i \le m-2$ implica que $2 \le m-i$ y por tanto $\mu(p^m)=\ldots=\mu(p^{m-i})=0$.
\end{itemize}
\end{enumerate}
\end{proof}

Del la demostración del \cref{it:ram1} se puede rescatar el siguiente corolario, usando la inversión de Möbius (\Cref{cor:mob1}).

\begin{corollary}\label{cor:ram5}
Para cada $n \in \mathbb{N}$ fijo se tiene
\begin{equation*}
    \sum_{d \mid r} c_d(n) = \eta_r(n) = \begin{cases}
        \hfil r & \text{si } r \mid n \\
        \hfil 0 & \text{en otro caso}.
    \end{cases}
\end{equation*}
\end{corollary}

Las sumas de Ramanujan gozan de la siguiente propiedad de ``ortogonalidad''.

\begin{lemma}\label{lem:ram4}
Si $r$ y $s$ dividen a $k$, entonces
\begin{equation*}
    \sum_{d \mid k} c_r(k/d) c_d(k/s) = \begin{cases}
        \hfil k & \text{si } r = s \\
        \hfil 0 & \text{en otro caso}.
    \end{cases}
\end{equation*}
\end{lemma}
\begin{proof}
Si $r$ y $s$ dividen a $k$, entonces
\begin{equation} \label{eq:ram2}
\begin{split}
\sum_{d \mid k} c_r (k/d) c_d (k/s) &= \sum_{d \mid k} c_d (k/s) \sum_{d' \mid (k/d,r)} \mu (r/d') d' \\
                                                                              &= \sum_{d \mid k} c_d (k/s) \sum_{\substack{d' \mid r \\ d' \mid k/d}} \mu(r/d') d' = \sum_{\substack{d \mid k \\ d' \mid r \\ d' \mid k/d}} c_d (k/s) \mu (r/d') d' \\
                                                                              &= \sum_{\substack{d \mid k/d' \\ d' \mid r \\ d' \mid r}} c_d(k/s) \mu(r/d')  d' = \sum_{\substack{d' \mid r \\ d' \mid k}} \mu(r/d') d' \sum_{d \mid k/d'} c_d(k/s) \\
                                                                              &= \sum_{d' \mid (k,r)} \mu(r/d) d' \eta_{k/d'} (k/s) = \sum_{d' \mid r} \mu(r/d) d' \eta_{k/d'} (k/s),
\end{split}
\end{equation}
dado que $(k,r)=r$ por ser $r$ divisor de $k$ y dado que los conjuntos $\{ d,d' \in \mathbb{N} \std d \mid k, d' \mid r, d' \mid k/d \}$ y $\{ d,d' \in \mathbb{N} \std d \mid k/d', d' \mid r, d' \mid k \}$ son iguales. En efecto, si $d \mid k$ entonces $k/d$ es un entero, lueg $d' \mid k/d$ implica que $k/d=d' q'$, luego $k=d' q' d$, por tanto $d \mid k/d'$ y $d' \mid k$.
\bigskip

Recíprocamente, si $d' \mid k$ entonces $k/d'$ es un entero, luego $d \mid k/d'$ implica que $k/d'=dq$, por tanto $k=d q d'$, por tanto $d \mid k$ y $d' \mid k/d$.
\bigskip

Si $s \centernot\mid r$ entonces $s \centernot\mid d'$ y por tanto $k/d' \centernot\mid k/s$. En efecto, pues si $s \mid d'$, como $d' \mid r$ entonces se tendría que $s \mid r$ por transitividad. Además, si $k/d' \mid k/s$ se tendría que $s \mid d'k$. Luego la suma \eqref{eq:ram2} se anula si $s \centernot\mid r$ y en particular si $r \ne s$, pues en este caso se tiene que $\eta_{k/d'}(k/s)=0$ para cada $d' \mid r$. 
\bigskip

Si $s \mid r$ entonces la suma \eqref{eq:ram2} es igual a
\begin{equation*}
\begin{split}
    \sum_{\substack{d' \mid r \\ k/d' \mid k/s}} \mu(r/d') d' \frac{k}{d'} &= \sum_{\substack{d' \mid r \\ k/d' \mid k/s}} \mu(r/d') k = \sum_{\substack{d' \mid r \\ s \mid d'}} \mu(r/d') k \\
    &= k \sum_{\substack{d' \mid r \\ d'=se}} \mu(r/se) = k \sum_{e \mid r/s} \mu(r/se) \\
    &= k \sum_{se \mid r} \mu(r/se) = \begin{cases}
        \hfil k & \text{si } r=s \\
        \hfil 0 & \text{en otro caso,}
    \end{cases}
\end{split}
\end{equation*}
pues $k/d' \mid k/s$ si y sólo si $s \mid d'$.
\end{proof}

\begin{corollary}\label{cor:ind}
Las sumas de Ramanujan son linealmente independientes respecto a la suma sobre los divisores de $r$. Más específicamente, si $\alpha, \beta$ son funciones aritméticas tales que
\begin{equation*}
    \sum_{d \mid r} \alpha(d) c_d(n) = \sum_{d \mid r} \beta(d) c_d(n),
\end{equation*}
para todo $n \in \mathbb{N}$, entonces $\alpha(d)=\beta(d)$ para todo $d \mid r$.
\end{corollary}
\begin{proof}
Basta probar que $\sum_{d \mid r} \alpha(d) c_d(n)=0$ implica que $\alpha(d)=0$ para todo $d \mid r$. Supóngase ésta hipótesis y sea $\delta \mid r$ arbitrario pero fijo. Si $e$ es un divisor de $r$, se tiene que $\sum_{d \mid r} \alpha(d) c_d(r/e)=0$, luego
\begin{align*}
    0 = \sum_{e \mid r} \left( \sum_{d \mid r} \alpha(d) c_d \left( \frac{r}{e} \right) \right) c_e \left( \frac{r}{\delta} \right)= \sum_{d \mid r} \alpha(d) \sum_{e \mid r} c_d \left( \frac{r}{e} \right) c_e \left( \frac{r}{\delta} \right) = \alpha(\delta) r,
\end{align*}
por el la proposición anterior, y dado que $r \ne 0$ entonces $\alpha(\delta)=0$. Como $\delta$ fue un divisor arbitrario de $r$, se tiene el resultado.
\end{proof}

\begin{lemma}
Si $d \mid r$ entonces $c_d(n)=c_d((n,r))$.
\end{lemma}
\begin{proof}
Si $d \mid r$ entonces $(n,d)=((n,r),d)$. En efecto, dado que $(n,d) \mid n$ y $(n,d) \mid d$, entonces $(n,d) \mid n$, $(n,d) \mid d$ y $(n,d) \mid r$, por lo que $(n,d) \mid (n,r)$ y $(n,d) \mid d$, es decir, $(n,d) \mid ((n,r),d)$. Recíprocamente se tiene que $((n,r),d) \mid n$ y $((n,r),d) \mid d$, así que $((n,r),d) \mid (n,d)$. Se sigue que $(n,d)=((n,r),d)$. Luego
\begin{equation*}
    c_d(n) = \sum_{e \mid (n,d)} \mu(d/e) e = \sum_{e \mid ((n,r),d)} \mu(d/e) e = c_d((n,r)).
\end{equation*}
\end{proof}

\begin{corollary}
La suma de Ramanujan módulo $r$ es par $\Mod{r}$.
\end{corollary}

\begin{definition}[Radical]
Sea $n \in \mathbb{N}$. Se define el \emph{radical} de $n$, denotado por $n_*$ como
\begin{equation*}
    n_* = \begin{cases}
        \hfil 1 & \text{si } n=1 \\
        \hfil p_1 \cdots p_r & \text{si } n = p_1^{\alpha_1} \cdots p_r^{\alpha_r}
    \end{cases}
\end{equation*}
donde $n=p_1^{\alpha_1} \cdots p_r^{\alpha_r}$ es la factorización de $n>1$ en primos.
\end{definition}

\begin{definition}
Una función aritmética $f$ se dirá \emph{separable} si $f(n)=f(n_*)$, para cada $n \in \mathbb{N}$.
\end{definition}

\begin{lemma}
Una función multiplicativa es separable si y sólo si $(\mu * f)(n)=0$ para todo $n$ no libre de cuadrado.
\end{lemma}
\begin{proof}
Sea $F=\mu * f$. Entonces $F*\mathbf{1}=f$, es decir,
\begin{equation*}
    \sum_{d \mid n} F(d) = f(n), \forall n \in \mathbb{N}.
\end{equation*}
Si $F(n)=0$ para cada $n$ no libre de cuadrado, entonces
\begin{equation*}
    f(n) = \sum_{d \mid n} F(d) = \sum_{d \mid n_*} F(d) = f(n_*),
\end{equation*}
es decir, $f$ es separable.
\bigskip

Supóngase ahora que $f$ es separable. Se tiene que para cada primo $p$ y para cada $m>1$,
\begin{align*}
    F(p^m) = \sum_{d \mid p^m} \mu(d) f \left( \frac{p^m}{d} \right) &= \mu(1)f(p^m) + \mu(p)f(p^{m-1}) \\
                                                                     &= f(p^m) - f(p^{m-1}) = f(p) - f(p) = 0.
\end{align*}
Además como $f$ es multiplicativa, entonces $F$ también lo es. Si $n$ es un entero positivo no libre de cuadrado, entonces existen un primo $p$ y enteros positivos $q$ y $m>1$ tales que $n=p^m q$ y $(p^m,q)=1$. Luego $F(n)=F(p^m)F(q)=0 \cdot F(q)=0$.
\end{proof}

\begin{lemma}\label{lem:par0}
Si $f$ es multiplicativa y separable, entonces para cualesquiera $a,b \in \mathbb{N}$ se tiene:
\begin{enumerate}[label=\textnormal{(\roman*)}]
\item $f(a)f(b)=f(a b)f((a,b))$.
\item $\displaystyle f(a) = f((a,b)) \sum_{\substack{d \mid a \\ (d,b) = 1}} (\mu * f)(d)$
\end{enumerate}
\end{lemma}

\begin{proof}
(\textsc{\romannumeral 1}) Nótese que si $p$ es un primo y $m,n > 1$ entonces
\begin{equation*}
    f(p^m)f(p^n) = f(p) f(p) = f(p^{m+n})f((p^m,p^n)),
\end{equation*}
pues $(p^m,p^n)=p^i$, con $i=\min \{ m,n \}$. Sean $a,b \in \mathbb{N}$ y escríbase sin pérdida de generalidad $a=p_1^{\alpha_1} \cdots p_r^{\alpha_r}$ y $b=p_1^{\beta_1} \cdots p_r^{\beta_r}$, $0 \le \alpha_i, \beta_i$. Entonces, como $f$ es multiplicativa,
\begin{align*}
    f(a b)f((a,b)) &= f(p_1^{\alpha_1+\beta_1} \cdots p_r^{\alpha_r+\beta_r}) f(p_1^{\min \{ \alpha_1,\beta_1 \}} \cdots p_r^{\min \{ \alpha_r,\beta_r \}}) \\
                   &= f(p_1^{\alpha_1+\beta_1}) \cdots f(p_r^{\alpha_r+\beta_r}) f(p_1^{\min \{ \alpha_1,\beta_1 \}}) \cdots f(p_r^{\min \{ \alpha_r,\beta_r \}}) \\
                   &= f(p_1^{\alpha_1+\beta_1}) \cdots f(p_r^{\alpha_r+\beta_r}) f((p_1^{\alpha_1},p_1^{\beta_1})) \cdots f((p_r^{\alpha_r},p_r^{\beta_r})) \\
                   &= f(p_1^{\alpha_1})f(p_1^{\beta_1}) \cdots f(p_r^{\alpha_r})f(p_r^{\beta_r}) \\
                   &= f(p_1^{\alpha_1} \cdots p_r^{\alpha_r})f(p_1^{\beta_1} \cdots p_r^{\beta_r}) \\
                   &= f(a)f(b)
\end{align*}
(\textsc{\romannumeral 2}) Al igual que en la demostración anterior, si $F=\mu * f$, entonces
\begin{equation*}
    \sum_{d \mid n} F(d) = f(n), \forall n \in \mathbb{N}.
\end{equation*}

Se verá primero que los conjuntos $\{ d \in \mathbb{N} \std d \mid a_* \text{ y } (d,b)=1\}$ y $\{ d \in \mathbb{N} \std d \mid a_* / (a,b)_* \}$ son iguales.
\bigskip

Para empezar, se tiene que $a_*/(a,b)_*$ es un entero. Si $(a,b)_*=1$ esto es claro. Si $(a,b)_*>1$ se puede escribir $(a,b)_*=q_1 \cdots q_s$, donde todos los primos son distintos. Luego $q_i \mid (a,b)_*$, pero $(a,b)_* \mid (a,b)$ y $(a,b) \mid a$, por tanto $q_i \mid a$ y por tanto $q_i \mid a_*$. Como $i \in \{ 1,\ldots,s \}$ fue arbitrario y todos los primos $q_i$ son distintos, entonces $q_1 \cdots q_s = (a,b)_* \mid a_*$, que es lo que se quería probar.
\bigskip

Procedamos a probar la igualdad de los conjuntos. Supóngase primero que $d \mid a_*$ y $(d,b)=1$. Entonces existe $c \in \mathbb{N}$ tal que $a_*=d c$. Por otro lado, se tiene que $(a,b) \mid b$ y por tanto $((a,b),d)=1$, más aún, como $(a,b)_* \mid (a,b)$ entonces también $((a,b)_*,d)=1$ y como $(a,b)_* \mid a_* = d c$, por el lema de Euclides se debe tener que $(a,b)_* \mid c$ es decir, $a_* = (a,b)_* d q$, para algún $q \in \mathbb{N}$, luego $d \mid a_* / (a,b)_*$.
\bigskip

Recíprocamente, supóngase que $d \mid a_*/(a,b)_*$. Se debe tener que
\begin{equation}\label{eq:mcd2}
    \left( \frac{a_*}{(a,b)_*},b \right) = 1.
\end{equation}
Pues en caso contrario, es decir, si este máximo común divisor fuera mayor que uno, existiría un primo $p$ tal que $p \mid b$ y $p \mid a_*/(a,b)_*$, pero $a_*/(a,b)_* \mid a_*$, luego $p \mid a_*$ y por tanto $p \mid a$. En consecuencia, $p \mid (a,b)$ y por tanto $p \mid (a,b)_*$. Se puede escribir entonces $a_*=p p_1 \cdots p_r$, $(a,b)_*= p q_1 \cdots q_s$, donde todos los primos son distintos. Además, como $a_*=(a,b)_* n$ para algún $n \in \mathbb{N}$, se tiene que
$p p_1 \cdots p_r = p q_1 \cdots q_s r_1 \cdots r_t$, con $n=r_1 \cdots r_t$, y $r_i$ números primos, no necesariamente distintos. Luego $p_1 \cdots p_r = q_1 \cdots q_s r_1 \cdots r_t$ y dado que ningúno de los primos $p_i$ son iguales a $p$, entonces ninguno de los primos $r_j$ puede ser igual a $p$, es decir $p$ no divide a $n=a_*/(a,b)_*$, lo cual es absurdo.
\bigskip

Esto prueba la igualdad de dichos conjuntos. Ahora es fácil calcular la siguiente suma,
\begin{equation*}
    \sum_{\substack{d \mid a \\ (d,b)=1}} F(d) = \sum_{\substack{ d \mid a_* \\ (d,b)=1}} F(d) = \sum_{d \mid a_* / (a,b)_*} F(d) = \sum_{d \mid (a_*/(a,b)_*)} (\mu * f)(d) = f(a_*/(a,b)_*).
\end{equation*}
Además, por una demostración similar a la de la \cref{eq:mcd2}, se tiene que
\begin{equation*}
    \left( (a,b)_*,\frac{a_*}{(a,b)_*} \right) = 1.
\end{equation*}
Finalmente, como $f$ es multiplicativa,
\begin{equation*}
    f(a) = f(a_*) = f((a,b)_*)f(a_*/(a,b)_*) = f((a,b)) \sum_{\substack{d \mid a \\ (d,b)=1}} (\mu * f)(d).
\end{equation*}
\end{proof}

\begin{example}
La función $\overline{\varphi}=\varphi(n)/n$ es separable. Nótese que para cualquier primo $p$ y $m>0$ se tiene $\varphi(p^m)=p^m-p^{m-1}$, luego $\varphi(p^m)/p^m=1-p^{-1}$ y también $\varphi(p)/p=1-p^{-1}$. Ahora, si $n=p_1^{\alpha_1} \cdots p_r^{\alpha_r}$ entonces, como $\varphi$ es multiplicativa,
\begin{equation*}
    \frac{\varphi(n)}{n} = \frac{\varphi(p_1^{\alpha_1})}{p_1^{\alpha_1}} \cdots \frac{\varphi(p_r^{\alpha_r})}{p_r^{\alpha^r}} = \left( 1-\frac{1}{p_1} \right) \cdots \left( 1-\frac{1}{p_r} \right) = \frac{\varphi(p_1)}{p_1} \cdots \frac{\varphi(p_r)}{p_r} = \frac{\varphi(n_*)}{n_*}
\end{equation*}
\end{example}

\begin{lemma}[Fórmula de Hölder]\label{lem:holder}
Para cada $n \in \mathbb{N}$ se tiene
\begin{equation*}
    c_r(n) = \frac{\varphi(r) \mu \left( \displaystyle \frac{r}{(n,r)} \right)}{\varphi \left( \displaystyle \frac{r}{(n,r)} \right)}
\end{equation*}
\end{lemma}

\begin{proof}
Se tiene
\begin{equation}\label{eq:par1}
    c_r (n) = \sum_{d \mid (n,r)} \mu \left( \frac{r}{d} \right) d = \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)}, \frac{(n,r)}{d} \right) > 1}} \mu \left( \frac{r}{d} \right) d + \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)}, \frac{(n,r)}{d} \right) = 1}} \mu \left( \frac{r}{d} \right) d,
\end{equation}
pero si $(r/(n,r),(n,r)/d)>1$ entonces $r/d$ debe tener un factor cuadrado, pues en este caso existe un primo $p$ tal que $p \mid r/(n,r)$ y $p \mid (n,r)/d$, luego $r=p (n,r) q_1$ y $(n,r)=p d q_2$ para algunos enteros $q_1$ y $q_2$, luego $r=p^2 d q_1 q_2$ y por tanto $p^2 \mid r/d$, así que $\mu(r/d)=0$. Luego la ecuación \eqref{eq:par1} es igual a
\begin{equation}\label{eq:par2}
\begin{split}
    \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)}, \frac{(n,r)}{d} \right) = 1}} \mu \left( \frac{r}{d} \right) d & = \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)}, \frac{(n,r)}{d} \right) = 1}} \mu \left( \frac{r}{(n,r)} \right) \mu \left( \frac{(n,r)}{d} \right) d \\
    & = \mu \left( \frac{r}{(n,r)} \right) \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)}, \frac{(n,r)}{d} \right) = 1}} \mu \left( \frac{(n,r)}{d} \right) d \\
    & = \mu \left( \frac{r}{(n,r)} \right) \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)},d \right)=1}} \mu(d) \frac{(n,r)}{d} \\
    & = (n,r) \mu \left( \frac{r}{(n,r)} \right) \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r),d} \right)=1}} \frac{\mu(d)}{d}
\end{split}
\end{equation}
pues $\mu$ es multiplicativa. Sea ahora $\Phi=\mu * \overline{\varphi}$, donde $\overline{\varphi}(s)=\varphi(s)/s$ para cada $s \in \mathbb{N}$. Se tiene entonces que
\begin{equation}\label{eq:par3}
\begin{split}
    \Phi(s) = \sum_{d \mid s} \mu(d) \overline{\varphi} \left( \frac{s}{d} \right) & = \sum_{d \mid s} \mu(d) \varphi \left( \frac{s}{d} \right) \frac{1}{s/d} = \sum_{d \mid s} \mu(d) \sum_{e \mid s/d} \mu(e) \frac{s/d}{e} \frac{1}{s/d} \\
            & = \sum_{d \mid s} \mu(d) \sum_{e \mid s/d} \frac{\mu(e)}{e}  = \sum_{e \mid s} \frac{\mu(e)}{e} \sum_{d \mid s/e} \mu(d) = \frac{\mu(s)}{s}
\end{split}
\end{equation}
pues si $d \mid s$ y $c \mid s/d$, entonces $d/s$ es un entero y $s/d=e q$ para algún entero $q$, luego $s= d e q$ y por tanto $e \mid s$ y $d \mid s/e$. El recíproco es similar. Además, todos los términos en la penúltima suma son cero excepto aquel para el cual $s/e = 1$, es decir, $s=e$. Luego la suma \eqref{eq:par2} es igual a
\begin{align*}
    (n,r) \mu \left( \frac{r}{(n,r)} \right) \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)},d \right)=1}} \Phi(d) & = (n,r) \mu \left( \frac{r}{(n,r)} \right) \sum_{\substack{d \mid (n,r) \\ \left( \frac{r}{(n,r)},d \right)=1}} (\mu * \overline{\varphi}(d)) \\
    & = (n,r) \mu \left( \frac{r}{(n,r)} \right) \frac{\overline{\varphi}((n,r))}{\overline{\varphi} \left( (n,r), \frac{r}{(n,r)} \right)} \\
    & = (n,r) \mu \left( \frac{r}{(n,r)} \right) \frac{\overline{\varphi}(r)\overline{\varphi}((n,r))}{\overline{\varphi}((n,r))\overline{\varphi} \left( \frac{r}{(n,r)} \right)} \\
    & = (n,r) \mu \left( \frac{r}{(n,r)} \right) \frac{\overline{\varphi}(r)}{\overline{\varphi}\left( \frac{r}{(n,r)} \right)} \\
    & = (n,r)\mu \left( \frac{r}{(n,r)} \right) \frac{r \varphi(r)}{(n,r) r \varphi \left( \frac{r}{(n,r)} \right)} \\
    & = \frac{\mu \left( \frac{r}{(n,r)} \right) \varphi(r)}{\varphi \left( \frac{r}{(n,r)} \right)}
\end{align*}
donde la primera igualdad se cumple por definición de $\Phi$ y la ecuación \eqref{eq:par3}, la segunda por ser $\overline{\varphi}$ multiplicativa, separable y por el \Cref{lem:par0} (\textsc{\romannumeral 2}), la tercera por el \Cref{lem:par0} (\textsc{\romannumeral 1}) y la quinta por definición de $\overline{\varphi}$.
\end{proof}

\begin{theorem}\label{thm:fou1}
Toda función $f$ par $\Mod{r}$ tiene una expansión de la forma
\begin{equation}\label{eq:ram3}
    f(n) = \sum_{d \mid r} \alpha(d) c_d(n),
\end{equation}
y recíprocamente, toda función aritmética de esta forma es par $\Mod{r}$. Los coeficientes $\alpha(d)$ están dados por
\begin{equation}\label{eq:ram6}
    \alpha(d) = \frac{1}{r} \sum_{e \mid r} f \left( \frac{r}{e} \right) c_e \left( \frac{r}{d} \right),
\end{equation}
o por la fórmula equivalente,
\begin{equation*}
    \alpha(d) = \frac{1}{r \varphi(d)} \sum_{m=1}^{r} f(m) c_d(m).
\end{equation*}
A los coeficientes $\alpha$ se les llamará \textbf{coeficientes de Fourier} de la función par $f$.
\end{theorem}
\begin{proof}
Es claro que toda función de la forma \eqref{eq:ram3} es par $\Mod{r}$, pues por el lema anterior si $d \mid r$ entonces $c_d(n)=c_d((n,r))$. Nótese que
\begin{equation*}
\begin{split}
    \sum_{d \mid r} \alpha(d) c_d(n) &= \sum_{d \mid r} \left( \frac{1}{r} \sum_{e \mid r} f \left( \frac{r}{e} \right) c_e \left( \frac{r}{d} \right) \right) c_d(n) \\
                                     &= \frac{1}{r} \sum_{e \mid r} f \left( \frac{r}{e} \right) \sum_{d \mid r} c_e \left( \frac{r}{d} \right) c_d(n) \\
                                     &= \frac{1}{r} \sum_{e \mid r} f \left( \frac{r}{e} \right) \sum_{d \mid r} c_e \left( \frac{r}{d} \right) c_d((n,r)) \\
                                     &= \frac{1}{r} f \left( \frac{r}{q} \right) r = f((n,r)) = f(n),
\end{split}
\end{equation*}
por el \Cref{lem:ram4}, donde $r=(n,r) q$, para algún $q \in \mathbb{N}$ y donde la última igualdad se cumple por ser $f$ par $\Mod{r}$.
\bigskip

Por otro lado, de la demostración de la \cref{eq:gauss1} se puede rescatar el hecho de que el conjunto $\{ 1,2,\ldots,r \}$ es igual a $\bigcup_{e \mid r} \{ rx/e \std (x,e)=1, 1 \le x \le e \}$ y todos los conjuntos son disjuntos a pares, por tanto
\begin{equation*}
\begin{split}
    \frac{1}{r \varphi(d)}\sum_{m=1}^{r} f(m) c_d(m) &= \frac{1}{r \varphi(d)}\sum_{e \mid r} \sum_{\substack{(x,e)=1 \\ 1 \le x \le e}} f \left( \frac{rx}{e} \right) c_d \left( \frac{rx}{e} \right) \\
                               &= \frac{1}{r \varphi(d)}\sum_{e \mid r} \sum_{\substack{(x,e)=1 \\ 1 \le x \le e}} f \left( \left( \frac{rx}{e},r \right) \right) c_d \left( \left( \frac{rx}{e},r \right) \right) \\
                               &= \frac{1}{r \varphi(d)}\sum_{e \mid r} \sum_{\substack{(x,e)=1 \\ 1 \le x \le e}} f \left( \frac{r}{e} \right) c_d \left( \frac{r}{e} \right) \\
                               &= \frac{1}{r \varphi(d)}\sum_{e \mid r} f \left( \frac{r}{e} \right) c_d \left( \frac{r}{e} \right) \varphi(e) \\
                               &= \frac{1}{r \varphi(d)}\sum_{e \mid r} f \left( \frac{r}{e} \right) c_e \left( \frac{r}{d} \right) \varphi(d) \\
                               &= \frac{1}{r}\sum_{e \mid r} \left( \frac{r}{e} \right) c_e \left( \frac{r}{d} \right),
\end{split}
\end{equation*}
donde la segunda igualdad se cumple por ser $f$ par $\Mod{r}$, la tercera por ser $(rx/e,r)=r/e$, pues $(x,e)=1$ implica que $(r/e)(x,e)=r/e$, y como $r/e$ es un entero positivo, entonces $(rx/e,r)=r/e$. La cuarta por definición de $\varphi$, y la penúltima igualdad se cumple por la fórmula de Hölder (\Cref{lem:holder}) y el \Cref{cor:mcd1}, pues $e$ y $d$ dividen a $d$, así que
\begin{equation}\label{eq:holder}
    c_d \left( \frac{r}{e} \right) \varphi(e) = \frac{\varphi(d)\mu \left( \displaystyle \frac{d}{(r/e,d)} \right)}{\varphi \left( \displaystyle \frac{d}{(r/e,d)} \right)} = \frac{\varphi(d)\mu \left( \displaystyle \frac{e}{(r/d,e)} \right)}{\varphi \left( \displaystyle \frac{e}{(r/d,e)} \right)} \varphi(e) = \varphi(d) c_e \left( \frac{r}{d} \right)
\end{equation}
\end{proof}

\begin{corollary}
Si $f$ y $f'$ son funciones pares $\Mod{r}$, entonces se verifican las siguientes implicaciones
\begin{equation*}
    f(n) = \sum_{d \mid r} f'(d) c_d(n), \forall n \in \mathbb{N} \implies f'(\delta) = \frac{1}{r \varphi(\delta)} \sum_{m=1}^{r} f(m) c_d(m), \forall \delta \mid r,
\end{equation*}
\begin{equation*}
    f'(\delta) = \sum_{m=1}^{r} f(m) c_{\delta} (m), \forall d \mid r \implies f(n) = \frac{1}{r} \sum_{d \mid r} \frac{f'(d)}{\varphi(d)} c_d(n), \forall n \in \mathbb{N}.
\end{equation*}
\end{corollary}
\begin{proof}
En efecto, como $f$ es par, entonces $f$ tiene una única representación de la forma \eqref{eq:ram3}, por tanto se verifica la primera implicación. Para la segunda implicación se tiene que, de nuevo por la \cref{eq:ram3},
\begin{equation*}
    f(n) = \sum_{d \mid r} \left( \frac{1}{r \varphi(d)} \sum_{m=1}^{r} f(m) c_d(m) \right) c_d(n) = \frac{1}{r} \sum_{d \mid r} \frac{f'(d)}{\varphi(d)} c_d(n).
\end{equation*}
\end{proof}

Considerando los casos $\delta=1$ y $n=r$ se tiene el siguiente corolario.

\begin{corollary}
Si $f$ y $f'$ son funciones pares $\Mod{r}$, entonces
\begin{equation*}
    f(n) = \sum_{d \mid r} f'(d) c_d(n), \forall n \in \mathbb{N} \implies f'(1) = \frac{1}{r} \sum_{m=1}^{r} f(m),
\end{equation*}
\begin{equation*}
    f'(\delta) = \sum_{m=1}^{r} f(m) c_{\delta}(m), \forall d \mid r \implies f(r) = \frac{1}{r} \sum_{d \mid r} f'(d).
\end{equation*}
\end{corollary}

Volviendo a la definición de la suma de Ramanujan módulo $r$, \cref{eq:ram0}, se puede considerar una clase más general de funciones, aquellas que se pueden escribir como
\begin{equation*}
    f(n) = \sum_{\delta \mid (n,r)} g(\delta), \forall n \in \mathbb{N},
\end{equation*}
donde $g$ es una función aritmética.
\bigskip

La siguiente proposición muestra que esta generalización preserva la modularidad respecto a $r$. Más aún, el \Cref{thm:fou1} permite caracterizar a las funciones pares módulo $r$ de esta forma.

\begin{theorem}
Toda función $f$ par módulo $r$ se puede expresar como
\begin{equation}\label{eq:fou2}
    f(n) = \sum_{\delta \mid (n,r)} g(\delta), \forall n \in \mathbb{N}.
\end{equation}
Y recíprocamente, toda función aritmética que tenga esta forma es par módulo $r$.
\end{theorem}
\begin{proof}
Dado que $(n,r)=((n,r),r)$, es claro que toda función arimética que tenga dicha forma es par $\Mod{r}$. Supóngase que $f$ es par $\Mod{r}$. Por el \Cref{thm:fou1}, se puede escribir
\begin{align*}
    f(n) & = \sum_{d \mid r} \alpha(d) c_d(n) = \sum_{d \mid r} \alpha(d) \sum_{\delta \mid (n,d)} \mu \left( \frac{d}{\delta} \right) \delta \\
         & = \sum_{\delta \mid (n,d)} \sum_{d \mid r} \alpha(d) \mu \left( \frac{d}{\delta} \right) \delta = \sum_{\delta \mid (n,r)} \delta \sum_{d \mid r} \mu \left( \frac{d}{\delta} \right) \delta = \sum_{\delta \mid (n,r)} g(\delta) 
\end{align*}
\end{proof}

En vista de que toda función par tiene al menos dos representaciones, la del teorema anterior y la del \Cref{thm:fou1}, cabe preguntarse si existe alguna relación entre ellas. El siguiente teorema da respuesta a esta inquietud.

\begin{theorem}
Si $f$ es par módulo $r$, entonces sus respectivas expansiones \eqref{eq:ram3} y \eqref{eq:fou2} están relacionadas mediante la fórmula
\begin{equation*}
    \alpha(d) = \frac{1}{r} \sum_{e \mid r/d} g \left( \frac{r}{e} \right) e.
\end{equation*}
\end{theorem}
\begin{proof}
Se tiene que
\begin{align*}
    \alpha(d) = \frac{1}{r} \sum_{\delta \mid r} f \left( \frac{r}{\delta} \right) c_{\delta} \left( \frac{r}{d} \right) & = \frac{1}{r} \sum_{\delta \mid r} c_{\delta} \left( \frac{r}{d} \right) \sum_{e \mid (r/\delta,\delta)} g(e) = \frac{1}{r} \sum_{\delta \mid r} c_{\delta} \left( \frac{r}{d} \right) \sum_{e \mid r/\delta} g(e) \\
              & = \frac{1}{r} \sum_{\delta \mid r} c_{\delta} \left( \frac{r}{d} \right) \sum_{e \mid r/\delta} g(e) = \frac{1}{r} \sum_{e \mid r} g \left( \frac{r}{e} \right) \sum_{\delta \mid e} c_{\delta} \left( \frac{r}{d} \right) \\
              & = \frac{1}{r} \sum_{e \mid r} g \left( \frac{r}{e} \right) \cdot \begin{cases}
                  \hfil e & \text{si } e \mid r/d \\
                  \hfil 0 & \text{en otro caso} \\
              \end{cases} = \frac{1}{r} \sum_{e \mid r/d} g \left( \frac{r}{e} \right) e.
\end{align*}
por el \cref{cor:ram5}.
\end{proof}

\subsection{El subespacio de funciones pares}

Recuérdese del \cref{cor:est1} que el anillo $(\mathcal{A}, +, *)$ es un álgebra conmutativa con identidad. Se tiene que el conjunto de funciones pares es un subespacio de $\mathcal{A}$, pero no es un subanillo, pues en general $(f*g)(n) \ne (f*g)((n,r))$ aún cuando $f$ y $g$ sean pares $\Mod{r}$, tome por ejemplo dos funciones constantes. Se denotará como $\mathcal{A}_r$ al conjunto de funciones pares módulo $r$.

\begin{proposition}
El conjunto $\mathcal{A}_r$ es una subespacio de $\mathcal{A}$.
\end{proposition}
\begin{proof}
Basta verificar las siguientes condiciones:
\begin{enumerate}[label=\textnormal{(\roman*)}]
\item $\mathcal{A}_r \ne \emptyset$
\item $f, g \in \mathcal{A}_r$ implica $f+g \in \mathcal{A}_r$
\item $c \in \mathbb{C}$ y $f \in \mathcal{A}_r$ implica $c f \in \mathcal{A}$.
\end{enumerate}
Claro que $\mathbf{0} \in \mathcal{A}_r$. Sea $n \in \mathbb{N}$ y supóngase que $f, g \in \mathcal{A}_r$. Se tiene que $(c f)(n) = c f(n) = c f((n,r)) = (c f)((n,r))$, luego $c f \in \mathcal{A}_r$.
\bigskip

Además, $(f+g)(n)=f(n)+g(n)=f((n,r))+g((n,r))=(f+g)((n,r))$, así que $f+g \in \mathcal{A}_r$.
\bigskip
\end{proof}

El \cref{cor:ind} afirma que las sumas de Ramanujan $\mathcal{B}_r = \{ c_d \}_{d \mid r}$ son linealmente independientes respecto a la suma sobre los divisores de $r$, además el \Cref{thm:fou1} nos permite expresar cualquier función par como una suma de este tipo. En otras palabras, el conjunto $\mathcal{B}_r$ es una base del espacio vectorial $\mathcal{A}_r$.

\begin{corollary}
El espacio vectorial $\mathcal{A}_r$ tiene dimensión $d(r)$.
\end{corollary}

En lo que sigue de esta sección se verá que los coeficientes de la expansión \eqref{eq:ram3} pueden ser derivados de un producto interno en este espacio de funciones.

\begin{proposition}
La operación $\langle \phantom{f},\phantom{g} \rangle : \mathcal{A}_r\times \mathcal{A}_r \longrightarrow \mathbb{R}$ definida como
\begin{equation*}
    \langle f,g \rangle = \sum_{d \mid r} \varphi(d) f \left( \frac{r}{d} \right) \overline{g \left( \frac{r}{d} \right)}
\end{equation*}
es un producto interno en $\mathcal{A}_r$.
\end{proposition}
\begin{proof}
Sean $c \in \mathbb{C}$ y $f,g,h \in \mathcal{A}_r$. Escríbase $f(n)=f_1(n)+ i f_2(n)$ para todo $n \in \mathbb{N}$, donde $f_1,f_2 \in \mathcal{A}_{\mathbb{R}}$. Entonces
\begin{enumerate}[label=\textnormal{(\roman*)}]
\item \begin{align*}
        \langle f,f \rangle & = \sum_{d \mid r} \varphi(d) \left[ f_1 \left( \frac{r}{d} \right) + i f_2 \left( \frac{r}{d} \right) \right] \overline{\left[ f_1 \left( \frac{r}{d} \right) + i f_2 \left( \frac{r}{d} \right) \right]} \\
                            & = \sum_{d \mid r} \varphi(d) \left[ f_1^2 \left( \frac{r}{d} \right) + f_2^2 \left( \frac{r}{d} \right) \right] \ge 0
\end{align*}
Además, si $\langle f,f \rangle=0$, como todos los términos de la suma anterior son positivos, se debe tener que $f_1(d)=f_2(d)=0$ para todo $d$ divisor de $r$. Si $n \in \mathbb{N}$ entonces $f_1(n)=f((n,r))=0$, pues $f$ es par $\Mod{r}$ y $(n,r) \mid r$. Análogamente se tiene $f_2(n)=0$. Luego $f(n)=f_1(n)+i f_2(n)=0$ para cada $n \in \mathbb{N}$, es decir $f=\mathbf{0}$.
\item \begin{align*}
        \langle f+g,h \rangle & = \sum_{d \mid r} \varphi(d) (f+g) \left( \frac{r}{d} \right) \overline{g \left( \frac{r}{d} \right)} = \sum_{d \mid r} \varphi(d) \left[ f \left( \frac{r}{d} \right) \overline{h \left( \frac{r}{d} \right)} + g \left( \frac{r}{d} \right) \overline{h \left( \frac{r}{d} \right)} \right] \\
                              & = \sum_{d \mid r} \varphi(d) f \left( \frac{r}{d} \right) \overline{h \left( \frac{r}{d} \right)} + \sum_{d \mid r} g \left( \frac{r}{d} \right) \overline{h \left( \frac{r}{d} \right)} = \langle f,h \rangle + \langle g,h \rangle
\end{align*}
\item \begin{equation*}
    \langle c f,g \rangle = \sum_{d \mid r} \varphi(d) c f \left( \frac{r}{d} \right) \overline{g \left( \frac{r}{d} \right)} = c \sum_{d \mid r} \varphi(d) f \left( \frac{r}{d} \right) \overline{g\left( \frac{r}{d} \right)} = c \langle f,g \rangle
\end{equation*}
\item \begin{equation*}
    \overline{\langle g,f \rangle} = \overline{\sum_{d \mid r} \varphi(d) g \left( \frac{r}{d} \right) \overline{f \left( \frac{r}{d} \right)}} = \sum_{d \mid r} \varphi(d) f \left( \frac{r}{d} \right) \overline{g \left( \frac{r}{d} \right)} = \langle f,g \rangle
\end{equation*}
\end{enumerate}
\end{proof}

El producto interno así definido podría haberse escrito sin el factor $\varphi(d)$ dentro de la suma. Su uso se justifica al usar la ecuación \eqref{eq:holder} para probar que este producto interno hace de $\mathcal{B}_r$ una base ortogonal de $\mathcal{A}_r$.

\begin{proposition}
Si $i,j$ son divisores positivos de $r$, entonces
\begin{equation*}
    \langle c_i,c_j \rangle = \begin{cases}
        \hfil r \varphi(j) & \text{si } i=j \\
        \hfil 0 & \text{en otro caso}.
    \end{cases}
\end{equation*}
\end{proposition}
\begin{proof}
En efecto,
\begin{equation*}
    \langle c_i,c_j \rangle = \sum_{d \mid r} \varphi(d) c_i \left( \frac{r}{d} \right) c_j \left( \frac{r}{d} \right) = \sum_{d \mid r} c_i \left( \frac{r}{d} \right) \varphi(j) c_d \left( \frac{r}{j} \right) = 
    \begin{cases}
        \hfil r \varphi(j) & \text{si } i=j \\
        \hfil 0 & \text{en otro caso},
    \end{cases}
\end{equation*}
donde la segunda igualdad se cumple por la \cref{eq:holder} y la tercera por el \Cref{lem:ram4}.
\end{proof}

\begin{corollary}
El conjunto
\begin{equation*}
    \mathcal{B}'_r = \left\{ c'_d = \frac{1}{\sqrt{r \varphi(d)}} c_d \right\}_{d \mid r}
\end{equation*}
es una base ortonormal de $\mathcal{A}_r$.
\end{corollary}

Como consecuencia del corolario anterior, toda función $f$ par $\Mod{r}$ debe tener una expansión de la forma $\sum_{e \mid r} \beta(e) c'_e$. Además, si $d$ es un divisor arbitrario de $r$, entonces
\begin{equation*}
    \left\langle f, c'_d \right\rangle = \left\langle \sum_{e \mid r} \beta(e) c'_e,c'_d \right\rangle = \sum_{e \mid r} \beta(e) \left\langle c'_e,c'_d \right\rangle = \beta(d),
\end{equation*}
pero $f$ también tiene una única representación de la forma $\sum_{e \mid r} \alpha(d) c_d$, en consecuencia, $\alpha(d) = \beta(d)/\sqrt{r \varphi(d)}$ para cada $d$ divisor de $r$. Por tanto,
\begin{align*}
    \alpha(d) & = \frac{\beta(d)}{\sqrt{r \varphi(d)}} = \frac{1}{\sqrt{r \varphi(d)}} \left\langle f, c'_d \right\rangle \\
                                                     & = \frac{1}{\sqrt{r \varphi(d)}} \sum_{e \mid r} \varphi(e) f \left( \frac{r}{e} \right) c'_d \left( \frac{r}{e} \right) \\
                                                     & = \frac{1}{\sqrt{r \varphi(d)}} \sum_{e \mid r} \varphi(e) f \left( \frac{r}{e} \right) \frac{1}{\sqrt{r \varphi(d)}} c_d \left( \frac{r}{e} \right) \\
                                                     & = \frac{1}{r \varphi(d)} \sum_{e \mid r} f \left( \frac{r}{e} \right) \varphi(d) c_e \left( \frac{r}{d} \right) \\
                                                     & = \frac{1}{r} \sum_{e \mid r} f \left( \frac{r}{e} \right) c_e \left( \frac{r}{d} \right),
\end{align*}
donde la cuarta igualdad se cumple nuevamente por \eqref{eq:holder}. Esta es la \cref{eq:ram6}. Como es usual en el análisis funcional, ahora se pueden llamar propiamente \emph{coeficientes de Fourier} a los coeficientes $\alpha$ del \Cref{thm:fou1}.
